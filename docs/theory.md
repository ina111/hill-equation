# ヒルの方程式の理論的背景

## 概要

ヒルの方程式（Hill's Equations）は、円軌道上を運動する主衛星（ターゲット）に対する、近傍の追跡衛星（チェイサー）の相対運動を記述する線形微分方程式です。これらの方程式は、1960年にClohessyとWiltshireによって衛星のランデブー問題に適用され、Clohessy-Wiltshire（CW）方程式とも呼ばれます。

## 座標系の定義

### LVLH座標系（Local Vertical Local Horizontal）

ターゲット衛星を原点とする右手系座標系：

- **x軸（Radial）**: 地心からターゲット衛星に向かう方向（外向き正）
- **y軸（Along-track）**: ターゲット衛星の軌道進行方向（速度ベクトル方向）
- **z軸（Cross-track）**: 軌道面に垂直、軌道角運動量ベクトル方向

### Three.jsとの座標軸の違い

**重要**: Three.jsと物理学/宇宙工学では軸定義が異なります：

| 軸 | 物理学/宇宙工学 | Three.js |
|---|---|---|
| 上方向 | z軸正 | y軸正 |
| 前方向 | y軸正 | -z軸負 |
| 右方向 | x軸正 | x軸正 |

**座標変換**: 物理座標 → Three.js座標
- x_three = x_physics
- y_three = z_physics  
- z_three = -y_physics

## 基本仮定

1. ターゲット衛星は完全な円軌道上を運動
2. チェイサーはターゲットの近傍に存在（|r| << R₀）
3. 地球の重力場は中心力場
4. 摂動力は無視できる

## 運動方程式の導出

### 慣性座標系から回転座標系への変換

慣性座標系での運動方程式から始めて、LVLH座標系（回転座標系）への変換を行います：

```
r̈ᵢ = -μ/|r|³ · r
```

LVLH座標系での相対位置ベクトルを **ρ** = [x, y, z]ᵀ とすると：

```
ρ̈ + 2Ω × ρ̇ + Ω̇ × ρ + Ω × (Ω × ρ) = aᵣₑₗ
```

ここで：
- **Ω** = [0, 0, n]ᵀ は軌道角速度ベクトル
- n = √(μ/R₀³) は平均運動（軌道角速度）
- μ = 3.986004418 × 10¹⁴ m³/s² は地球の重力定数
- R₀ はターゲット衛星の軌道半径

### 線形化過程

相対距離が軌道半径に比べて十分小さい（|ρ| << R₀）という仮定の下で、重力勾配項を展開し線形化を行います。

## ヒルの方程式

最終的に得られる線形微分方程式：

```
ẍ - 2nẏ - 3n²x = 0   (Radial方向)
ÿ + 2nẋ = 0           (Along-track方向)  
z̈ + n²z = 0          (Cross-track方向)
```

### 各項の物理的意味

- **3n²x**: 重力勾配項（潮汐力）
- **2nẏ, 2nẋ**: コリオリ力項
- **n²z**: Cross-track方向の復元力

## 解析解

### 初期条件

t = 0 での初期条件：
- 位置: (x₀, y₀, z₀)
- 速度: (ẋ₀, ẏ₀, ż₀)

### 厳密解

**面内運動（x-y平面）**:
```
x(t) = (4 - 3cos(nt))x₀ + (sin(nt)/n)ẋ₀ + (2(1-cos(nt))/n)ẏ₀

y(t) = (6(sin(nt) - nt))x₀ + y₀ + (2(cos(nt)-1)/n)ẋ₀ + ((4sin(nt) - 3nt)/n)ẏ₀

ẋ(t) = 3n sin(nt)x₀ + cos(nt)ẋ₀ + 2sin(nt)ẏ₀

ẏ(t) = 6n(cos(nt) - 1)x₀ + 2sin(nt)ẋ₀ + (4cos(nt) - 3)ẏ₀
```

**面外運動（z方向）**:
```
z(t) = cos(nt)z₀ + (sin(nt)/n)ż₀

ż(t) = -n sin(nt)z₀ + cos(nt)ż₀
```

## 物理的解釈

### 運動の特性

1. **面内運動（x-y平面）**
   - x方向（径方向）とy方向（軌道進行方向）の運動は結合
   - y方向に永年項（secular term）によるドリフトが発生
   - 周期的な楕円運動が重畳

2. **面外運動（z方向）**
   - 他の方向と独立
   - 単純な調和振動
   - 周期 T = 2π/n（軌道周期と同じ）

### 特殊な軌道

1. **周期軌道**
   - ドリフトなしで閉軌道を描く特殊な初期条件
   - 条件: ẏ₀ = -2nx₀

2. **ホーマン軌道**
   - 燃料効率の良い移転軌道

3. **レコード盤軌道（3次元Football orbit）**
   - 面内Football orbitと面外調和振動の組み合わせによる3次元周期軌道
   - Hill方程式の解析解を組み合わせた安定軌道
   
   **パラメトリック表現**:
   ```
   x(t) = ρ cos(nt + φ)              // 面内Football orbit
   y(t) = -2ρ sin(nt + φ)            // 面内Football orbit  
   z(t) = ρz cos(nt + φz)            // 面外調和振動
   ```
   
   **初期条件** (ρ = 面内半径、ρz = 面外振幅、φ = 面内位相、φz = 面外位相):
   ```
   x₀ = ρ cos(φ)
   y₀ = -2ρ sin(φ)  
   z₀ = ρz cos(φz)
   
   ẋ₀ = -ρn sin(φ)
   ẏ₀ = -2ρn cos(φ)
   ż₀ = -ρz n sin(φz)
   ```
   
   **位相関係による軌道形状**:
   - φz = φ: z軸方向がx軸と同期
   - φz = φ + π/2: z軸方向がy軸と同期  
   - φz = φ + π/6: 30度傾斜効果
   - ρz = ρ tan(θ): 見かけの傾斜角θ
   
   **特性**:
   - 軌道周期: T = 2π/n（全成分が同期）
   - Hill方程式の厳密解による安定性保証
   - 実用例: 3次元編隊飛行、多角的観測
   - 応用: 科学観測ミッションでの立体配置

### エネルギーと積分

相対運動系では以下の積分が存在：
- Jacobi積分: C = n²(3x² - z²) - 2(ẋ² + ẏ² + ż²)

## 応用

### 宇宙ミッション
- 衛星のランデブー・ドッキング
- 編隊飛行
- 軌道上サービシング
- デブリ除去
- ISS補給ミッション

### 制御への応用
ヒルの方程式の線形性により、最適制御理論の適用が容易：
- インパルス制御
- 連続推力制御
- 燃料最適化
- LQR制御

## 制限事項と適用範囲

1. **有効範囲**: 相対距離が軌道半径の約1%以下
2. **軌道離心率**: 円軌道のみ（楕円軌道には修正が必要）
3. **摂動**: J2項などの摂動効果は含まれない
4. **非線形効果**: 大きな相対運動では精度が低下
5. **高度**: 低軌道での大気抵抗は考慮されない

## 数値例

地球低軌道（高度400km）での典型値：
- 軌道半径: R₀ ≈ 6778 km
- 平均運動: n ≈ 1.13 × 10⁻³ rad/s
- 軌道周期: T ≈ 92.7 分

## 参考文献

1. Clohessy, W. H. and Wiltshire, R. S., "Terminal Guidance System for Satellite Rendezvous," Journal of the Aerospace Sciences, Vol. 27, No. 9, 1960.

2. Alfriend, K. T., et al., "Spacecraft Formation Flying: Dynamics, Control and Navigation," Elsevier, 2010.

3. Fehse, W., "Automated Rendezvous and Docking of Spacecraft," Cambridge University Press, 2003.

4. Vallado, D. A., "Fundamentals of Astrodynamics and Applications," 4th Edition, Microcosm Press, 2013.